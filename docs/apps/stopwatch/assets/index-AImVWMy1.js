import{j as t,r as c}from"./index-z5vQhEjP.js";const f=({title:e,onClick:a,disabled:r})=>t.jsx("button",{type:"button",className:"slap-button",onClick:a,disabled:r,children:e}),m=({children:e})=>t.jsx("p",{className:"slap-inline-text",children:e}),j="stopwatch-state.json",L=e=>t.jsxs("article",{children:[t.jsx("strong",{children:"Stopwatch"}),t.jsx("p",{children:"Simple stopwatch with lap recording."})]}),M=e=>{const a=Math.floor(e/1e3),r=Math.floor(a/3600),l=Math.floor(a%3600/60),i=a%60,s=Math.floor(e%1e3/10);return`${r.toString().padStart(2,"0")}:${l.toString().padStart(2,"0")}:${i.toString().padStart(2,"0")}.${s.toString().padStart(2,"0")}`},T=({ctx:e})=>{const[a,r]=c.useState(0),[l,i]=c.useState(null),[s,h]=c.useState(!1),[p,w]=c.useState([]),[g,u]=c.useState("Ready."),[S,v]=c.useState(Date.now());c.useEffect(()=>{(async()=>{const n=await e.vfs.readText(j);if(n)try{const o=JSON.parse(n);if(typeof o.accumulatedMs=="number"&&o.accumulatedMs>=0&&r(o.accumulatedMs),Array.isArray(o.laps)){const R=o.laps.filter(x=>typeof x=="number"&&x>=0);w(R.slice(0,20))}o.isRunning===!0&&typeof o.startedAtEpochMs=="number"&&(h(!0),i(o.startedAtEpochMs),u("Resumed running timer."))}catch{u("Saved data was invalid.")}})()},[e.vfs]),c.useEffect(()=>{e.vfs.writeText(j,JSON.stringify({accumulatedMs:a,startedAtEpochMs:l,isRunning:s,laps:p},null,2))},[e.vfs,a,l,s,p]),c.useEffect(()=>{if(!s)return;const n=window.setInterval(()=>v(Date.now()),60);return()=>window.clearInterval(n)},[s]);const d=c.useMemo(()=>!s||l===null?a:a+Math.max(0,S-l),[s,a,l,S]),A=()=>{s||(i(Date.now()),h(!0),u("Running."))},E=()=>{if(!s||l===null)return;const n=a+Math.max(0,Date.now()-l);r(n),i(null),h(!1),u("Paused.")},y=()=>{h(!1),i(null),r(0),w([]),u("Reset.")},b=()=>{d<=0||(w(n=>[d,...n].slice(0,20)),u("Lap captured."))},N=c.useMemo(()=>M(d),[d]);return t.jsxs("section",{className:"slap-shell",children:[t.jsx(m,{children:"Simple stopwatch with laps."}),t.jsx("p",{className:"stopwatch-display",children:N}),t.jsx(m,{children:g}),t.jsxs("div",{className:"slap-button-row",children:[t.jsx(f,{title:s?"Running":"Start",onClick:A,disabled:s}),t.jsx(f,{title:"Pause",onClick:E,disabled:!s}),t.jsx(f,{title:"Lap",onClick:b,disabled:d<=0}),t.jsx(f,{title:"Reset",onClick:y})]}),t.jsxs("section",{className:"stopwatch-laps",children:[t.jsxs("h3",{className:"slap-title",children:["Laps (",p.length,")"]}),p.length===0?t.jsx(m,{children:"No laps yet."}):null,p.map((n,o)=>t.jsxs(m,{children:["Lap ",p.length-o,": ",M(n)]},`${n}-${o}`))]})]})},k={id:"stopwatch",title:"Stopwatch",author:"Joel",description:"Simple stopwatch with lap recording.",icon:"⏱️",Preview:L,Application:T};export{k as stopwatchManifest};
