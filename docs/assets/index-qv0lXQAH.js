import{r as n,j as t}from"./index-C9LANGui.js";import{b as f,d as m}from"./index-Cbq74euv.js";const M="stopwatch-state.json",L=r=>t.jsxs("article",{children:[t.jsx("strong",{children:"Stopwatch"}),t.jsx("p",{children:"Simple stopwatch with lap recording."})]}),j=r=>{const o=Math.floor(r/1e3),u=Math.floor(o/3600),c=Math.floor(o%3600/60),l=o%60,s=Math.floor(r%1e3/10);return`${u.toString().padStart(2,"0")}:${c.toString().padStart(2,"0")}:${l.toString().padStart(2,"0")}.${s.toString().padStart(2,"0")}`},T=({ctx:r})=>{const[o,u]=n.useState(0),[c,l]=n.useState(null),[s,h]=n.useState(!1),[i,w]=n.useState([]),[g,p]=n.useState("Ready."),[S,v]=n.useState(Date.now());n.useEffect(()=>{(async()=>{const e=await r.vfs.readText(M);if(e)try{const a=JSON.parse(e);if(typeof a.accumulatedMs=="number"&&a.accumulatedMs>=0&&u(a.accumulatedMs),Array.isArray(a.laps)){const N=a.laps.filter(x=>typeof x=="number"&&x>=0);w(N.slice(0,20))}a.isRunning===!0&&typeof a.startedAtEpochMs=="number"&&(h(!0),l(a.startedAtEpochMs),p("Resumed running timer."))}catch{p("Saved data was invalid.")}})()},[r.vfs]),n.useEffect(()=>{r.vfs.writeText(M,JSON.stringify({accumulatedMs:o,startedAtEpochMs:c,isRunning:s,laps:i},null,2))},[r.vfs,o,c,s,i]),n.useEffect(()=>{if(!s)return;const e=window.setInterval(()=>v(Date.now()),60);return()=>window.clearInterval(e)},[s]);const d=n.useMemo(()=>!s||c===null?o:o+Math.max(0,S-c),[s,o,c,S]),A=()=>{s||(l(Date.now()),h(!0),p("Running."))},E=()=>{if(!s||c===null)return;const e=o+Math.max(0,Date.now()-c);u(e),l(null),h(!1),p("Paused.")},y=()=>{h(!1),l(null),u(0),w([]),p("Reset.")},R=()=>{d<=0||(w(e=>[d,...e].slice(0,20)),p("Lap captured."))},b=n.useMemo(()=>j(d),[d]);return t.jsxs("section",{className:"slap-shell",children:[t.jsx(f,{children:"Simple stopwatch with laps."}),t.jsx("p",{className:"stopwatch-display",children:b}),t.jsx(f,{children:g}),t.jsxs("div",{className:"slap-button-row",children:[t.jsx(m,{title:s?"Running":"Start",onClick:A,disabled:s}),t.jsx(m,{title:"Pause",onClick:E,disabled:!s}),t.jsx(m,{title:"Lap",onClick:R,disabled:d<=0}),t.jsx(m,{title:"Reset",onClick:y})]}),t.jsxs("section",{className:"stopwatch-laps",children:[t.jsxs("h3",{className:"slap-title",children:["Laps (",i.length,")"]}),i.length===0?t.jsx(f,{children:"No laps yet."}):null,i.map((e,a)=>t.jsxs(f,{children:["Lap ",i.length-a,": ",j(e)]},`${e}-${a}`))]})]})},C={id:"stopwatch",title:"Stopwatch",author:"Joel",description:"Simple stopwatch with lap recording.",icon:"⏱️",Preview:L,Application:T};export{C as stopwatchManifest};
