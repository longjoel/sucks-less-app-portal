import{r as u,j as t}from"./index-DLl7wlIp.js";import{S as v,a as g,b as T}from"./index-ChKhXfTB.js";const I="calculator-state.json",H=100,J=n=>t.jsxs("article",{children:[t.jsx("strong",{children:"Calculator"}),t.jsx("p",{children:"4-function handheld style calculator with history."})]}),y=n=>Number.isFinite(n)?Math.abs(n)>=1e12||Math.abs(n)>0&&Math.abs(n)<1e-9?n.toExponential(6):n.toString():"Error",w=(n,l,s)=>s==="+"?n+l:s==="-"?n-l:s==="*"?n*l:l===0?null:n/l,$=n=>n==="*"?"Ã—":n==="/"?"Ã·":n,U=n=>{if(typeof n!="object"||n===null)return!1;const l=n;return typeof l.id=="string"&&typeof l.expression=="string"&&typeof l.result=="string"&&typeof l.createdAtIso=="string"},W=({ctx:n})=>{const[l,s]=u.useState("0"),[N,C]=u.useState([]),[a,d]=u.useState(null),[p,b]=u.useState(null),[S,h]=u.useState(null),[E,m]=u.useState(null),[x,r]=u.useState(!0);u.useEffect(()=>{(async()=>{const e=await n.vfs.readText(I);if(e)try{const c=JSON.parse(e);if(typeof c!="object"||c===null)return;const i=c;typeof i.display=="string"&&s(i.display),Array.isArray(i.history)&&C(i.history.filter(U).slice(0,H))}catch{s("0")}})()},[n.vfs]),u.useEffect(()=>{const e={display:l,history:N};n.vfs.writeText(I,JSON.stringify(e))},[n.vfs,l,N]);const M=(e,c)=>{const i={id:crypto.randomUUID(),expression:e,result:c,createdAtIso:new Date().toISOString()};C(f=>[i,...f].slice(0,H))},D=()=>{s("0"),d(null),b(null),h(null),m(null),r(!0)},o=e=>{if(l==="Error"){s(e),r(!1);return}if(x){s(e),r(!1);return}s(c=>c==="0"?e:`${c}${e}`)},L=()=>{if(l==="Error"){s("0."),r(!1);return}if(x){s("0."),r(!1);return}l.includes(".")||s(e=>`${e}.`)},A=(e,c,i,f)=>{const k=w(e,c,i);if(k===null){s("Error"),d(null),b(null),h(null),m(null),r(!0);return}const O=y(k);s(O),d(k),r(!0),M(`${y(e)} ${$(i)} ${y(c)}`,O)},j=e=>{const c=Number(l);if(l==="Error"||Number.isNaN(c))return;if(p!==null&&a!==null&&!x){const f=w(a,c,p);if(f===null){s("Error"),d(null),b(null),h(null),m(null),r(!0);return}const k=y(f);s(k),d(f),h(null),m(null),b(e),r(!0);return}d(a===null||x?c:a),b(e),r(!0)},_=()=>{if(l==="Error")return;const e=Number(l);if(!Number.isNaN(e)){if(p!==null&&a!==null){const c=x?a:e;A(a,c,p),h(p),m(c),b(null);return}S!==null&&E!==null&&A(e,E,S)}},F=()=>{if(l==="Error")return;const e=Number(l);Number.isNaN(e)||(s(y(e*-1)),r(!1))},P=()=>{if(l==="Error")return;const e=Number(l);Number.isNaN(e)||(s(y(e/100)),r(!1))},R=()=>{C([])},V=u.useMemo(()=>p===null||a===null?"":`${y(a)} ${$(p)}`,[p,a]);return t.jsxs(v,{title:"Calculator",children:[t.jsx(g,{title:"4-Function Calculator"}),t.jsxs("section",{className:"calc-screen","aria-label":"Calculator display",children:[t.jsx(T,{children:V||"Ready"}),t.jsx("p",{className:"calc-display",children:l})]}),t.jsxs("section",{className:"calc-grid","aria-label":"Calculator keypad",children:[t.jsx("button",{type:"button",className:"calc-key calc-key-meta",onClick:D,children:"C"}),t.jsx("button",{type:"button",className:"calc-key calc-key-meta",onClick:F,children:"+/-"}),t.jsx("button",{type:"button",className:"calc-key calc-key-meta",onClick:P,children:"%"}),t.jsx("button",{type:"button",className:"calc-key calc-key-op",onClick:()=>j("/"),children:"Ã·"}),t.jsx("button",{type:"button",className:"calc-key",onClick:()=>o("7"),children:"7"}),t.jsx("button",{type:"button",className:"calc-key",onClick:()=>o("8"),children:"8"}),t.jsx("button",{type:"button",className:"calc-key",onClick:()=>o("9"),children:"9"}),t.jsx("button",{type:"button",className:"calc-key calc-key-op",onClick:()=>j("*"),children:"Ã—"}),t.jsx("button",{type:"button",className:"calc-key",onClick:()=>o("4"),children:"4"}),t.jsx("button",{type:"button",className:"calc-key",onClick:()=>o("5"),children:"5"}),t.jsx("button",{type:"button",className:"calc-key",onClick:()=>o("6"),children:"6"}),t.jsx("button",{type:"button",className:"calc-key calc-key-op",onClick:()=>j("-"),children:"-"}),t.jsx("button",{type:"button",className:"calc-key",onClick:()=>o("1"),children:"1"}),t.jsx("button",{type:"button",className:"calc-key",onClick:()=>o("2"),children:"2"}),t.jsx("button",{type:"button",className:"calc-key",onClick:()=>o("3"),children:"3"}),t.jsx("button",{type:"button",className:"calc-key calc-key-op",onClick:()=>j("+"),children:"+"}),t.jsx("button",{type:"button",className:"calc-key calc-key-wide",onClick:()=>o("0"),children:"0"}),t.jsx("button",{type:"button",className:"calc-key",onClick:L,children:"."}),t.jsx("button",{type:"button",className:"calc-key calc-key-op",onClick:_,children:"="})]}),t.jsxs("section",{className:"calc-history","aria-label":"Calculation history",children:[t.jsxs("div",{className:"calc-history-header",children:[t.jsx(g,{title:"History"}),t.jsx("button",{type:"button",className:"calc-clear-history",onClick:R,children:"Clear"})]}),N.length===0?t.jsx(T,{children:"No calculations yet."}):null,N.map(e=>t.jsxs("article",{className:"calc-history-item",children:[t.jsx("strong",{children:e.expression}),t.jsxs("span",{children:["= ",e.result]})]},e.id))]})]})},Y={id:"calculator",title:"Calculator",author:"Joel",description:"4-function calculator with persistent history.",icon:"ðŸ§®",Preview:J,Application:W};export{Y as calculatorManifest};
